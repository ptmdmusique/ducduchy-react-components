import{r as a,R as E}from"./index-CTjT7uj6.js";import{p as re}from"./use-disposables-BgtiGxt7.js";import{u as $,o as Y,c as D,l as K,O as pe,U as _,y as te,v as L,b as ne,a as w,t as Z,C as ie}from"./render-C-IlGZgy.js";import{c as he}from"./use-flags-B0uNXtCz.js";import{f as le}from"./use-is-mounted-DsBFbocb.js";import{s as be,d as R,u as ae}from"./open-closed-CcTP-TJU.js";function ge(r){let e={called:!1};return(...t)=>{if(!e.called)return e.called=!0,r(...t)}}function z(r,...e){r&&e.length>0&&r.classList.add(...e)}function G(r,...e){r&&e.length>0&&r.classList.remove(...e)}function Ee(r,e){let t=Y();if(!r)return t.dispose;let{transitionDuration:l,transitionDelay:v}=getComputedStyle(r),[h,m]=[l,v].map(u=>{let[i=0]=u.split(",").filter(Boolean).map(o=>o.includes("ms")?parseFloat(o):parseFloat(o)*1e3).sort((o,b)=>b-o);return i}),d=h+m;if(d!==0){t.group(i=>{i.setTimeout(()=>{e(),i.dispose()},d),i.addEventListener(r,"transitionrun",o=>{o.target===o.currentTarget&&i.dispose()})});let u=t.addEventListener(r,"transitionend",i=>{i.target===i.currentTarget&&(e(),u())})}else e();return t.add(()=>e()),t.dispose}function Te(r,e,t,l){let v=t?"enter":"leave",h=Y(),m=l!==void 0?ge(l):()=>{};v==="enter"&&(r.removeAttribute("hidden"),r.style.display="");let d=$(v,{enter:()=>e.enter,leave:()=>e.leave}),u=$(v,{enter:()=>e.enterTo,leave:()=>e.leaveTo}),i=$(v,{enter:()=>e.enterFrom,leave:()=>e.leaveFrom});return G(r,...e.base,...e.enter,...e.enterTo,...e.enterFrom,...e.leave,...e.leaveFrom,...e.leaveTo,...e.entered),z(r,...e.base,...d,...i),h.nextFrame(()=>{G(r,...e.base,...d,...i),z(r,...e.base,...d,...u),Ee(r,()=>(G(r,...e.base,...d),z(r,...e.base,...e.entered),m()))}),h.dispose}function Fe({immediate:r,container:e,direction:t,classes:l,onStart:v,onStop:h}){let m=le(),d=re(),u=D(t);K(()=>{r&&(u.current="enter")},[r]),K(()=>{let i=Y();d.add(i.dispose);let o=e.current;if(o&&u.current!=="idle"&&m.current)return i.dispose(),v.current(u.current),i.add(Te(o,l.current,u.current==="enter",()=>{i.dispose(),h.current(u.current)})),i.dispose},[t])}function F(r=""){return r.split(/\s+/).filter(e=>e.length>1)}let A=a.createContext(null);A.displayName="TransitionContext";var Re=(r=>(r.Visible="visible",r.Hidden="hidden",r))(Re||{});function $e(){let r=a.useContext(A);if(r===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return r}function we(){let r=a.useContext(q);if(r===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return r}let q=a.createContext(null);q.displayName="NestingContext";function B(r){return"children"in r?B(r.children):r.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function se(r,e){let t=D(r),l=a.useRef([]),v=le(),h=re(),m=w((f,s=L.Hidden)=>{let c=l.current.findIndex(({el:n})=>n===f);c!==-1&&($(s,{[L.Unmount](){l.current.splice(c,1)},[L.Hidden](){l.current[c].state="hidden"}}),h.microTask(()=>{var n;!B(l)&&v.current&&((n=t.current)==null||n.call(t))}))}),d=w(f=>{let s=l.current.find(({el:c})=>c===f);return s?s.state!=="visible"&&(s.state="visible"):l.current.push({el:f,state:"visible"}),()=>m(f,L.Unmount)}),u=a.useRef([]),i=a.useRef(Promise.resolve()),o=a.useRef({enter:[],leave:[],idle:[]}),b=w((f,s,c)=>{u.current.splice(0),e&&(e.chains.current[s]=e.chains.current[s].filter(([n])=>n!==f)),e==null||e.chains.current[s].push([f,new Promise(n=>{u.current.push(n)})]),e==null||e.chains.current[s].push([f,new Promise(n=>{Promise.all(o.current[s].map(([S,N])=>N)).then(()=>n())})]),s==="enter"?i.current=i.current.then(()=>e==null?void 0:e.wait.current).then(()=>c(s)):c(s)}),g=w((f,s,c)=>{Promise.all(o.current[s].splice(0).map(([n,S])=>S)).then(()=>{var n;(n=u.current.shift())==null||n()}).then(()=>c(s))});return a.useMemo(()=>({children:l,register:d,unregister:m,onStart:b,onStop:g,wait:i,chains:o}),[d,m,l,b,g,o,i])}function xe(){}let Ce=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function ee(r){var e;let t={};for(let l of Ce)t[l]=(e=r[l])!=null?e:xe;return t}function Le(r){let e=a.useRef(ee(r));return a.useEffect(()=>{e.current=ee(r)},[r]),e}let Se="div",oe=pe.RenderStrategy;function Ne(r,e){var t,l;let{beforeEnter:v,afterEnter:h,beforeLeave:m,afterLeave:d,enter:u,enterFrom:i,enterTo:o,entered:b,leave:g,leaveFrom:f,leaveTo:s,...c}=r,n=a.useRef(null),S=te(n,e),N=(t=c.unmount)==null||t?L.Unmount:L.Hidden,{show:p,appear:x,initial:J}=$e(),[C,j]=a.useState(p?"visible":"hidden"),W=we(),{register:O,unregister:H}=W;a.useEffect(()=>O(n),[O,n]),a.useEffect(()=>{if(N===L.Hidden&&n.current){if(p&&C!=="visible"){j("visible");return}return $(C,{hidden:()=>H(n),visible:()=>O(n)})}},[C,n,O,H,p,N]);let k=D({base:F(c.className),enter:F(u),enterFrom:F(i),enterTo:F(o),entered:F(b),leave:F(g),leaveFrom:F(f),leaveTo:F(s)}),U=Le({beforeEnter:v,afterEnter:h,beforeLeave:m,afterLeave:d}),I=ne();a.useEffect(()=>{if(I&&C==="visible"&&n.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[n,C,I]);let ce=J&&!x,X=x&&p&&J,de=!I||ce?"idle":p?"enter":"leave",y=he(0),fe=w(T=>$(T,{enter:()=>{y.addFlag(R.Opening),U.current.beforeEnter()},leave:()=>{y.addFlag(R.Closing),U.current.beforeLeave()},idle:()=>{}})),ve=w(T=>$(T,{enter:()=>{y.removeFlag(R.Opening),U.current.afterEnter()},leave:()=>{y.removeFlag(R.Closing),U.current.afterLeave()},idle:()=>{}})),M=se(()=>{j("hidden"),H(n)},W),V=a.useRef(!1);Fe({immediate:X,container:n,classes:k,direction:de,onStart:D(T=>{V.current=!0,M.onStart(n,T,fe)}),onStop:D(T=>{V.current=!1,M.onStop(n,T,ve),T==="leave"&&!B(M)&&(j("hidden"),H(n))})});let P=c,me={ref:S};return X?P={...P,className:Z(c.className,...k.current.enter,...k.current.enterFrom)}:V.current&&(P.className=Z(c.className,(l=n.current)==null?void 0:l.className),P.className===""&&delete P.className),E.createElement(q.Provider,{value:M},E.createElement(be,{value:$(C,{visible:R.Open,hidden:R.Closed})|y.flags},ie({ourProps:me,theirProps:P,defaultTag:Se,features:oe,visible:C==="visible",name:"Transition.Child"})))}function Pe(r,e){let{show:t,appear:l=!1,unmount:v=!0,...h}=r,m=a.useRef(null),d=te(m,e);ne();let u=ae();if(t===void 0&&u!==null&&(t=(u&R.Open)===R.Open),![!0,!1].includes(t))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[i,o]=a.useState(t?"visible":"hidden"),b=se(()=>{o("hidden")}),[g,f]=a.useState(!0),s=a.useRef([t]);K(()=>{g!==!1&&s.current[s.current.length-1]!==t&&(s.current.push(t),f(!1))},[s,t]);let c=a.useMemo(()=>({show:t,appear:l,initial:g}),[t,l,g]);a.useEffect(()=>{if(t)o("visible");else if(!B(b))o("hidden");else{let p=m.current;if(!p)return;let x=p.getBoundingClientRect();x.x===0&&x.y===0&&x.width===0&&x.height===0&&o("hidden")}},[t,b]);let n={unmount:v},S=w(()=>{var p;g&&f(!1),(p=r.beforeEnter)==null||p.call(r)}),N=w(()=>{var p;g&&f(!1),(p=r.beforeLeave)==null||p.call(r)});return E.createElement(q.Provider,{value:b},E.createElement(A.Provider,{value:c},ie({ourProps:{...n,as:a.Fragment,children:E.createElement(ue,{ref:d,...n,...h,beforeEnter:S,beforeLeave:N})},theirProps:{},defaultTag:a.Fragment,features:oe,visible:i==="visible",name:"Transition"})))}function ye(r,e){let t=a.useContext(A)!==null,l=ae()!==null;return E.createElement(E.Fragment,null,!t&&l?E.createElement(Q,{ref:e,...r}):E.createElement(ue,{ref:e,...r}))}let Q=_(Pe),ue=_(Ne),De=_(ye),Be=Object.assign(Q,{Child:De,Root:Q});export{Be as q};
