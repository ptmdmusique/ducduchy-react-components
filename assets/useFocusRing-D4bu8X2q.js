import{R as q,r as c}from"./index-BCtMShv3.js";const I=typeof document<"u"?q.useLayoutEffect:()=>{};function J(e){const n=c.useRef(null);return I(()=>{n.current=e},[e]),c.useCallback((...t)=>{const r=n.current;return r==null?void 0:r(...t)},[])}const m=e=>{var n;return(n=e==null?void 0:e.ownerDocument)!==null&&n!==void 0?n:document},h=e=>e&&"window"in e&&e.window===e?e:m(e).defaultView||window;function Q(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&typeof e.nodeType=="number"}function X(e){return Q(e)&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in e}let Z=!1;function W(){return Z}function B(e,n){if(!W())return n&&e?e.contains(n):!1;if(!e||!n)return!1;let t=n;for(;t!==null;){if(t===e)return!0;t.tagName==="SLOT"&&t.assignedSlot?t=t.assignedSlot.parentNode:X(t)?t=t.host:t=t.parentNode}return!1}const x=(e=document)=>{var n;if(!W())return e.activeElement;let t=e.activeElement;for(;t&&"shadowRoot"in t&&(!((n=t.shadowRoot)===null||n===void 0)&&n.activeElement);)t=t.shadowRoot.activeElement;return t};function R(e){return W()&&e.target.shadowRoot&&e.composedPath?e.composedPath()[0]:e.target}function ee(e){var n;return typeof window>"u"||window.navigator==null?!1:((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.brands.some(t=>e.test(t.brand)))||e.test(window.navigator.userAgent)}function te(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function O(e){let n=null;return()=>(n==null&&(n=e()),n)}const ne=O(function(){return te(/^Mac/i)}),re=O(function(){return ee(/Android/i)});function _(){let e=c.useRef(new Map),n=c.useCallback((o,s,i,a)=>{let u=a!=null&&a.once?(...f)=>{e.current.delete(i),i(...f)}:i;e.current.set(i,{type:s,eventTarget:o,fn:u,options:a}),o.addEventListener(s,u,a)},[]),t=c.useCallback((o,s,i,a)=>{var u;let f=((u=e.current.get(i))===null||u===void 0?void 0:u.fn)||i;o.removeEventListener(s,f,a),e.current.delete(i)},[]),r=c.useCallback(()=>{e.current.forEach((o,s)=>{t(o.eventTarget,o.type,s,o.options)})},[t]);return c.useEffect(()=>r,[r]),{addGlobalListener:n,removeGlobalListener:t,removeAllGlobalListeners:r}}function oe(e){return e.mozInputSource===0&&e.isTrusted?!0:re()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}class V{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(n,t){this.nativeEvent=t,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.bubbles=t.bubbles,this.cancelable=t.cancelable,this.defaultPrevented=t.defaultPrevented,this.eventPhase=t.eventPhase,this.isTrusted=t.isTrusted,this.timeStamp=t.timeStamp,this.type=n}}function K(e){let n=c.useRef({isFocused:!1,observer:null});I(()=>{const r=n.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let t=J(r=>{e==null||e(r)});return c.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){n.current.isFocused=!0;let o=r.target,s=i=>{n.current.isFocused=!1,o.disabled&&t(new V("blur",i)),n.current.observer&&(n.current.observer.disconnect(),n.current.observer=null)};o.addEventListener("focusout",s,{once:!0}),n.current.observer=new MutationObserver(()=>{if(n.current.isFocused&&o.disabled){var i;(i=n.current.observer)===null||i===void 0||i.disconnect();let a=o===document.activeElement?null:document.activeElement;o.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),o.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),n.current.observer.observe(o,{attributes:!0,attributeFilter:["disabled"]})}},[t])}let ae=!1,y=null,C=new Set,L=new Map,w=!1,k=!1;const ie={Tab:!0,Escape:!0};function G(e,n){for(let t of C)t(e,n)}function ue(e){return!(e.metaKey||!ne()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function F(e){w=!0,ue(e)&&(y="keyboard",G("keyboard",e))}function v(e){y="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(w=!0,G("pointer",e))}function N(e){oe(e)&&(w=!0,y="virtual")}function j(e){e.target===window||e.target===document||ae||!e.isTrusted||(!w&&!k&&(y="virtual",G("virtual",e)),w=!1,k=!1)}function U(){w=!1,k=!0}function S(e){if(typeof window>"u"||L.get(h(e)))return;const n=h(e),t=m(e);let r=n.HTMLElement.prototype.focus;n.HTMLElement.prototype.focus=function(){w=!0,r.apply(this,arguments)},t.addEventListener("keydown",F,!0),t.addEventListener("keyup",F,!0),t.addEventListener("click",N,!0),n.addEventListener("focus",j,!0),n.addEventListener("blur",U,!1),typeof PointerEvent<"u"?(t.addEventListener("pointerdown",v,!0),t.addEventListener("pointermove",v,!0),t.addEventListener("pointerup",v,!0)):(t.addEventListener("mousedown",v,!0),t.addEventListener("mousemove",v,!0),t.addEventListener("mouseup",v,!0)),n.addEventListener("beforeunload",()=>{z(e)},{once:!0}),L.set(n,{focus:r})}const z=(e,n)=>{const t=h(e),r=m(e);n&&r.removeEventListener("DOMContentLoaded",n),L.has(t)&&(t.HTMLElement.prototype.focus=L.get(t).focus,r.removeEventListener("keydown",F,!0),r.removeEventListener("keyup",F,!0),r.removeEventListener("click",N,!0),t.removeEventListener("focus",j,!0),t.removeEventListener("blur",U,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",v,!0),r.removeEventListener("pointermove",v,!0),r.removeEventListener("pointerup",v,!0)):(r.removeEventListener("mousedown",v,!0),r.removeEventListener("mousemove",v,!0),r.removeEventListener("mouseup",v,!0)),L.delete(t))};function se(e){const n=m(e);let t;return n.readyState!=="loading"?S(e):(t=()=>{S(e)},n.addEventListener("DOMContentLoaded",t)),()=>z(e,t)}typeof document<"u"&&se();function Y(){return y!=="pointer"}const ce=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function de(e,n,t){let r=m(t==null?void 0:t.target);const o=typeof window<"u"?h(t==null?void 0:t.target).HTMLInputElement:HTMLInputElement,s=typeof window<"u"?h(t==null?void 0:t.target).HTMLTextAreaElement:HTMLTextAreaElement,i=typeof window<"u"?h(t==null?void 0:t.target).HTMLElement:HTMLElement,a=typeof window<"u"?h(t==null?void 0:t.target).KeyboardEvent:KeyboardEvent;return e=e||r.activeElement instanceof o&&!ce.has(r.activeElement.type)||r.activeElement instanceof s||r.activeElement instanceof i&&r.activeElement.isContentEditable,!(e&&n==="keyboard"&&t instanceof a&&!ie[t.key])}function le(e,n,t){S(),c.useEffect(()=>{let r=(o,s)=>{de(!!(t!=null&&t.isTextInput),o,s)&&e(Y())};return C.add(r),()=>{C.delete(r)}},n)}function fe(e){let{isDisabled:n,onFocus:t,onBlur:r,onFocusChange:o}=e;const s=c.useCallback(u=>{if(u.target===u.currentTarget)return r&&r(u),o&&o(!1),!0},[r,o]),i=K(s),a=c.useCallback(u=>{const f=m(u.target),g=f?x(f):x();u.target===u.currentTarget&&g===R(u.nativeEvent)&&(t&&t(u),o&&o(!0),i(u))},[o,t,i]);return{focusProps:{onFocus:!n&&(t||o||r)?a:void 0,onBlur:!n&&(r||o)?s:void 0}}}function ve(e){let{isDisabled:n,onBlurWithin:t,onFocusWithin:r,onFocusWithinChange:o}=e,s=c.useRef({isFocusWithin:!1}),{addGlobalListener:i,removeAllGlobalListeners:a}=_(),u=c.useCallback(l=>{l.currentTarget.contains(l.target)&&s.current.isFocusWithin&&!l.currentTarget.contains(l.relatedTarget)&&(s.current.isFocusWithin=!1,a(),t&&t(l),o&&o(!1))},[t,o,s,a]),f=K(u),g=c.useCallback(l=>{if(!l.currentTarget.contains(l.target))return;const E=m(l.target),b=x(E);if(!s.current.isFocusWithin&&b===R(l.nativeEvent)){r&&r(l),o&&o(!0),s.current.isFocusWithin=!0,f(l);let p=l.currentTarget;i(E,"focus",d=>{if(s.current.isFocusWithin&&!B(p,d.target)){let $=new V("blur",new E.defaultView.FocusEvent("blur",{relatedTarget:d.target}));$.target=p,$.currentTarget=p,u($)}},{capture:!0})}},[r,o,f,i,u]);return n?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:g,onBlur:u}}}let H=!1,M=0;function D(){H=!0,setTimeout(()=>{H=!1},50)}function A(e){e.pointerType==="touch"&&D()}function be(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",A):document.addEventListener("touchend",D),M++,()=>{M--,!(M>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",A):document.removeEventListener("touchend",D))}}function $e(e){let{onHoverStart:n,onHoverChange:t,onHoverEnd:r,isDisabled:o}=e,[s,i]=c.useState(!1),a=c.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;c.useEffect(be,[]);let{addGlobalListener:u,removeAllGlobalListeners:f}=_(),{hoverProps:g,triggerHoverEnd:l}=c.useMemo(()=>{let E=(d,$)=>{if(a.pointerType=$,o||$==="touch"||a.isHovered||!d.currentTarget.contains(d.target))return;a.isHovered=!0;let T=d.currentTarget;a.target=T,u(m(d.target),"pointerover",P=>{a.isHovered&&a.target&&!B(a.target,P.target)&&b(P,P.pointerType)},{capture:!0}),n&&n({type:"hoverstart",target:T,pointerType:$}),t&&t(!0),i(!0)},b=(d,$)=>{let T=a.target;a.pointerType="",a.target=null,!($==="touch"||!a.isHovered||!T)&&(a.isHovered=!1,f(),r&&r({type:"hoverend",target:T,pointerType:$}),t&&t(!1),i(!1))},p={};return typeof PointerEvent<"u"?(p.onPointerEnter=d=>{H&&d.pointerType==="mouse"||E(d,d.pointerType)},p.onPointerLeave=d=>{!o&&d.currentTarget.contains(d.target)&&b(d,d.pointerType)}):(p.onTouchStart=()=>{a.ignoreEmulatedMouseEvents=!0},p.onMouseEnter=d=>{!a.ignoreEmulatedMouseEvents&&!H&&E(d,"mouse"),a.ignoreEmulatedMouseEvents=!1},p.onMouseLeave=d=>{!o&&d.currentTarget.contains(d.target)&&b(d,"mouse")}),{hoverProps:p,triggerHoverEnd:b}},[n,t,r,o,a,u,f]);return c.useEffect(()=>{o&&l({currentTarget:a.target},a.pointerType)},[o]),{hoverProps:g,isHovered:s}}function ge(e={}){let{autoFocus:n=!1,isTextInput:t,within:r}=e,o=c.useRef({isFocused:!1,isFocusVisible:n||Y()}),[s,i]=c.useState(!1),[a,u]=c.useState(()=>o.current.isFocused&&o.current.isFocusVisible),f=c.useCallback(()=>u(o.current.isFocused&&o.current.isFocusVisible),[]),g=c.useCallback(b=>{o.current.isFocused=b,i(b),f()},[f]);le(b=>{o.current.isFocusVisible=b,f()},[],{isTextInput:t});let{focusProps:l}=fe({isDisabled:r,onFocusChange:g}),{focusWithinProps:E}=ve({isDisabled:!r,onFocusWithinChange:g});return{isFocused:s,isFocusVisible:a,focusProps:r?E:l}}export{ge as $,$e as a};
